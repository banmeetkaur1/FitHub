Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@react-native-async-storage/async-storage"),t=require("@react-native-community/netinfo");function a(e){return e&&e.__esModule?e:{default:e}}var r,c=a(e),n=a(t),i=(e,t)=>{try{if(e)return JSON.parse(e)}catch(e){}return t};exports.makeAsyncStorage=({dataKey:e="graphcache-data",metadataKey:t="graphcache-metadata",maxAge:a=7}={})=>{var s=Math.floor((new Date).valueOf()/864e5),d={};return{readData:async()=>{if(!Object.keys(d).length){var t=null;try{t=await c.default.getItem(e)}catch(e){}var r=i(t,{});Object.assign(d,r)}var n=!1;if(Object.keys(d).forEach((e=>{s-Number(e)>a&&(n=!0,delete d[e])})),n)try{await c.default.setItem(e,JSON.stringify(d))}catch(e){}return Object.assign({},...Object.keys(d).map((e=>d[e])))},writeData:async t=>{if(!Object.keys(d).length){var a=null;try{a=await c.default.getItem(e)}catch(e){}var r=i(a,{});Object.assign(d,r)}var n={};for(var u in Object.keys(t).forEach((e=>{void 0===t[e]&&(n[e]=void 0)})),d)d[u]=Object.assign(d[u],n);d[s]=Object.assign(d[s]||{},t);try{await c.default.setItem(e,JSON.stringify(d))}catch(e){}},writeMetadata:async e=>{try{await c.default.setItem(t,JSON.stringify(e))}catch(e){}},readMetadata:async()=>{var e=null;try{e=await c.default.getItem(t)}catch(e){}return i(e,[])},onOnline:e=>{r&&(r(),r=void 0),r=n.default.addEventListener((({isConnected:t})=>{t&&e()}))},clear:async()=>{try{d={},await c.default.removeItem(e),await c.default.removeItem(t)}catch(e){}}}};
//# sourceMappingURL=urql-storage-rn.min.js.map
